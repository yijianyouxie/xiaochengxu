(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/create"],{"288d":function(t,e,n){"use strict";n.r(e);var o=n("94c5"),i=n("aa4b");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("7f9a");var s,a=n("f0c5"),u=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);e["default"]=u.exports},"4f9d":function(t,e,n){"use strict";(function(t){function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function o(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(e){i(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={data:function(){return{symbol:"￥",message:"无",coupons:"未选择",invoice:"不开发票",goodsTotal:0,order:{},formData:{coupon:"",invoice:"",discount:0,freight:0,score:0,total:0,needAddress:!1,mustUseScore:!1,exchangePointsForCash:!1,remarks:"无",delivery_type:"express",canUseScore:0,usedScore:0,score2moneyRate:0,address:{},goodsList:[]}}},computed:{freightText:function(){return 0==this.formData.freight?"免运费":this.symbol+(this.formData.freight/100).toFixed(2)},discountText:function(){return this.symbol+(this.formData.discount/100).toFixed(2)},totalText:function(){var t=0;return this.formData.exchangePointsForCash&&(t=this.formData.usedScore*this.formData.score2moneyRate),((this.goodsTotal-this.formData.discount)/100-t).toFixed(2)},goodsTotalText:function(){return this.symbol+(this.goodsTotal/100).toFixed(2)},scoreText:function(){return"总积分:"+this.formData.score+"，其中"+this.formData.canUseScore+"积分可用"},scoreResultText:function(){return this.formData.usedScore<1?"不使用":"已选择"+this.formData.usedScore+"积分"},scoreMoneyResultText:function(){return this.formData.usedScore+""},userInfo:function(){return this.$store.state.user.userInfo}},onShow:function(){this.editData(this.getItemData()),this.loadData()},onUnload:function(){t.removeStorage({key:this.itemDataKey})},methods:{loadData:function(){var t=this;this.$request("mall/order/settlement",o(o({},this.formData),{},{address:void 0,goodsList:void 0}),{loading:!0}).then((function(e){t.editData(e),console.log("settlement res",e)}),(function(e){t.navTimeBack()})),this.buildTotal()},buildTotal:function(){var t=0;this.formData.goodsList.map((function(e){t+=e.price*e.amount})),this.goodsTotal=t},editData:function(t){for(var e in t)this.$set(this.formData,e,t[e]);this.goodsTotal=t.total},changeScore:function(){return this.userInfo.score<1?(this.$message("积分不足"),!1):this.formData.canUseScore<1?(this.$message("积分不可用"),!1):void this.$refs.scorePopup.open()},confirmEditScore:function(t){t<0&&(t=0),t>this.formData.canUseScore&&(t=this.formData.canUseScore),this.formData.usedScore=+t},changeInvoice:function(){var e=this;t.showModal({editable:!0,title:"请输入发票抬头",placeholderText:"请输入公司/个人名称",success:function(t){t.confirm&&(console.log(t.content),e.invoice=t.content,e.formData.invoice=t.content)}})},changeComment:function(){this.$refs.remarkPopup.open()},confirmEditComment:function(t){this.formData.remarks=t},submit:function(){var t=this;!this.formData.needAddress||this.formData.address._id?this.formData.goodsList?(console.log(o(o({},this.formData),{},{address:void 0,goodsList:void 0,submit:!0,address_id:this.formData.address._id})),this.$request("mall/order/settlement",o(o({},this.formData),{},{address:void 0,goodsList:void 0,submit:!0,address_id:this.formData.address._id}),{loading:!0}).then((function(e){console.log("settlement res",e),t.order=e,t.$refs.payment.open()}),(function(t){console.log("下单失败")}))):this.$message("商品不能为空"):this.$message("收货地址不能为空")},closePayment:function(){},paySuccess:function(e){console.log("pay success",e),e.id.indexOf(",")>-1?t.redirectTo({url:"/pages/order/order?type=undelivery"}):t.redirectTo({url:"/pages/order/detail?id="+e.id})}}};e.default=r}).call(this,n("543d")["default"])},"7f9a":function(t,e,n){"use strict";var o=n("ca82"),i=n.n(o);i.a},"94c5":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o}));var o={tianIcons:function(){return n.e("uni_modules/tian-mall/components/tian-icons/tian-icons").then(n.bind(null,"553d"))},tianEmpty:function(){return n.e("uni_modules/tian-mall/components/tian-empty/tian-empty").then(n.bind(null,"b061f"))},tianGoodsPrice:function(){return n.e("uni_modules/tian-mall/components/tian-goods-price/tian-goods-price").then(n.bind(null,"5efb"))},uniList:function(){return n.e("uni_modules/uni-list/components/uni-list/uni-list").then(n.bind(null,"bcc9"))},uniListItem:function(){return n.e("uni_modules/uni-list/components/uni-list-item/uni-list-item").then(n.bind(null,"a80a"))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"89d1"))},uniPopupDialog:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog")]).then(n.bind(null,"3399"))},tianPayment:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/tian-mall/components/tian-payment/tian-payment")]).then(n.bind(null,"5043"))}},i=function(){var t=this,e=t.$createElement;t._self._c},r=[]},aa4b:function(t,e,n){"use strict";n.r(e);var o=n("4f9d"),i=n.n(o);for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);e["default"]=i.a},b0ea:function(t,e,n){"use strict";(function(t){n("7a45");o(n("66fd"));var e=o(n("288d"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},ca82:function(t,e,n){}},[["b0ea","common/runtime","common/vendor"]]]);