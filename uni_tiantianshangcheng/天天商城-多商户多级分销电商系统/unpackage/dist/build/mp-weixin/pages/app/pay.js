(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/app/pay"],{1773:function(t,e,n){"use strict";n.r(e);var r=n("a369"),i=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=i.a},"4a44":function(t,e,n){"use strict";var r;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r}));var i=function(){var t=this,e=t.$createElement;t._self._c},a=[]},"544f":function(t,e,n){"use strict";(function(t){n("7a45");r(n("66fd"));var e=r(n("aa11"));function r(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},"6ba1":function(t,e,n){"use strict";var r=n("7a94"),i=n.n(r);i.a},"7a94":function(t,e,n){},a369:function(t,e,n){"use strict";(function(t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("ccec");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t.database();var c={data:function(){return{query:{},active:!1,showKeyboard:!1,chars:[],decimals:2,maxLength:8,dot:".",formData:{remarks:""},type:"",id:"61c9ae37b804f80001267d23",order:{}}},onLoad:function(t){if(t.q){var e=decodeURIComponent(t.q);Object.assign(t,o(o({},(0,i.getQueryString)(e)),{},{q:e}))}t.id?this.id=t.id:t.id=this.id,t.module||(t.module="shopqr"),console.log("onLoad",t),this.query=t,this.loadData(t),this.setGuangbiao(),r.hideHomeButton()},computed:{showMoney:function(){return this.chars.join("")},payMoney:function(){var t=this,e=0;return 0!=this.chars.length&&(e=-1==this.chars.indexOf(this.dot)?parseInt(this.chars.join("")):this.chars[0]==this.dot?parseFloat("0"+this.chars.filter((function(e,n){return n<=t.decimals})).join("")):parseFloat(this.chars.join(""))),e.toFixed(this.decimals)},bgStyle:function(){return this.order.background?"background: url(".concat(this.order.background,");background-size: 100%;background-repeat: no-repeat;"):"background:#ffffff"}},methods:{focus:function(){this.showKeyboard=!1},blur:function(){this.showKeyboard=!0},del:function(){this.chars.length>0&&this.chars.pop()},btn:function(t,e){if(e)-1==this.chars.indexOf(t)&&this.chars.push(t);else{var n=this.chars.indexOf(this.dot);if(-1==n&&this.chars.length>=this.maxLength)return;if(0==n);else if(n>this.maxLength)return;(-1==this.chars.indexOf(this.dot)||this.chars.length-n<=this.decimals)&&this.chars.push(t)}},loadData:function(t){var e=this;this.$request("payment/info",t).then((function(t){console.log(t),e.order=t.order,e.showKeyboard=!0})),r.getProvider({service:"payment",success:function(t){e.type=t.provider[0],console.log("this.type",e.type)}})},setGuangbiao:function(){var t=this;this.active=!0,setTimeout((function(){t.active=!1,setTimeout((function(){t.setGuangbiao()}),1e3)}),1e3)},paymentProcess:function(){var t=this;this.type&&(r.showLoading({title:"支付中",mask:!0}),this.$request("payment/pay",o(o(o({money:this.payMoney,type:this.type},this.formData),this.query),this.order)).then((function(e){r.hideLoading(),r.requestPayment(o(o({},e),{},{success:function(e){t.paySuccess()},fail:function(e){t.payFailed()}}))}),(function(e){t.payFailed()})))},paySuccess:function(t){var e=this;console.log("支付成功",t),this.$success("支付成功"),setTimeout((function(){r.redirectTo({url:"/pages/app/paysuccess?id=".concat(e.order.id)})}),2e3)},payFailed:function(){this.$message("支付失败"),this.loadData(this.query)}}};e.default=c}).call(this,n("a9ff")["default"],n("543d")["default"])},aa11:function(t,e,n){"use strict";n.r(e);var r=n("4a44"),i=n("1773");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("6ba1");var o,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],o);e["default"]=c.exports}},[["544f","common/runtime","common/vendor"]]]);